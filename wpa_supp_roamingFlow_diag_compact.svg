<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="920px" preserveAspectRatio="none" style="width:2522px;height:920px;" version="1.1" viewBox="0 0 2522 920" width="2522px" zoomAndPan="magnify"><defs><filter height="300%" id="f17pejpzmpq1g2" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="1214.25" cy="20" fill="#000000" filter="url(#f17pejpzmpq1g2)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="681" x="873.75" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="657" x="887.75" y="71.1387">For every scan Result 3 functions -&gt; wpa_bss_update_start,wpa_bss_update_scan_res,wpa_bss_update_end</text><path d="M503.75,108.3867 L503.75,133.5195 A0,0 0 0 0 503.75,133.5195 L914.75,133.5195 A0,0 0 0 0 914.75,133.5195 L914.75,126.3867 L934.75,120.9531 L914.75,118.3867 L914.75,118.3867 L904.75,108.3867 L503.75,108.3867 A0,0 0 0 0 503.75,108.3867 " fill="#FBFB77" filter="url(#f17pejpzmpq1g2)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M904.75,108.3867 L904.75,118.3867 L914.75,118.3867 L904.75,108.3867 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="390" x="509.75" y="125.4536">End BSS table update from scan result, wpa_supplicant/bss.c</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="559" x="934.75" y="103.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="539" x="944.75" y="125.1074">wpa_bss_update_end(struct wpa_supplicant *wpa_s, struct scan_info *info, int new_scan)</text><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="1061.75,157.9375,1366.75,157.9375,1378.75,169.9375,1366.75,181.9375,1061.75,181.9375,1049.75,169.9375,1061.75,157.9375" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="305" x="1061.75" y="173.7456">wpa_s-&gt;current_bss? connected to any network now?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="1028.75" y="167.3433">yes</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="318" x="324.875" y="191.9375"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="298" x="334.875" y="213.0762">add_to_advantech_whitelist(current_bss--&gt;bssid)</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="702" x="132.875" y="308.9063"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="678" x="146.875" y="330.0449">for every BSSID, initialize new_bss and reassign new_bss=current_bss, if current_bss-&gt;level &gt; new_bss-&gt;level</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="274" x="346.875" y="377.875"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="250" x="360.875" y="399.0137">after loop, we have best BSSID, new_bss</text><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="436.875,260.9063,530.875,260.9063,542.875,272.9063,530.875,284.9063,436.875,284.9063,424.875,272.9063,436.875,260.9063" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="94" x="436.875" y="276.7144">loop in bss table</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="136" x="415.875" y="455.7813"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="116" x="425.875" y="476.9199">wpa_get_network()</text><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="471.875,524.75,495.875,524.75,507.875,536.75,495.875,548.75,471.875,548.75,459.875,536.75,471.875,524.75" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="473.875" y="540.5581">n/w</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="438.875" y="534.1558">yes</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="152" x="225.75" y="607.1523"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="132" x="235.75" y="628.291">wpa_s_reassociate=1</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="316" x="143.75" y="676.1211"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="296" x="153.75" y="697.2598">wpa_supp_connect(wpa_s, new_bss, curr-&gt;ssid)</text><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="106.25,558.75,497.25,558.75,509.25,570.75,497.25,582.75,106.25,582.75,94.25,570.75,106.25,558.75" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="305.75" y="592.9604">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="387" x="106.25" y="574.5581">new BSSID roaming levels are better than current roaming levels ?</text><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="301.75,730.0898,313.75,742.0898,301.75,754.0898,289.75,742.0898,301.75,730.0898" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="189.25,774.0898,414.25,774.0898,426.25,786.0898,414.25,798.0898,189.25,798.0898,177.25,786.0898,189.25,774.0898" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="225" x="189.25" y="789.8979">n/w autoRoaming &amp;&amp; roam scan is &gt;=0</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="156.25" y="783.4956">yes</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="281" x="11" y="808.0898"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="261" x="21" y="829.2285">wpa_supp_request_scan(dlog scan period)</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="280" x="312" y="808.0898"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="260" x="322" y="829.2285">wpa_supp_request_scan(default 2 second)</text><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="301.75,848.0586,313.75,860.0586,301.75,872.0586,289.75,860.0586,301.75,848.0586" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="88" x="622" y="558.75"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="64" x="636" y="579.8887">do nothing</text><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="483.875,878.0586,495.875,890.0586,483.875,902.0586,471.875,890.0586,483.875,878.0586" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="1877.125,191.9375,1960.125,191.9375,1972.125,203.9375,1960.125,215.9375,1877.125,215.9375,1865.125,203.9375,1877.125,191.9375" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="83" x="1877.125" y="207.7456">any last SSID?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="1844.125" y="201.3433">yes</text><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="1463.375,225.9375,1487.375,225.9375,1499.375,237.9375,1487.375,249.9375,1463.375,249.9375,1451.375,237.9375,1463.375,225.9375" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="1465.375" y="241.7456">n/w</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="1430.375" y="235.3433">yes</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="702" x="910.875" y="307.9375"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="678" x="924.875" y="329.0762">for every BSSID, initialize new_bss and reassign new_bss=current_bss, if current_bss-&gt;level &gt; new_bss-&gt;level</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="274" x="1124.875" y="376.9063"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="250" x="1138.875" y="398.0449">after loop, we have best BSSID, new_bss</text><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="1185.375,259.9375,1338.375,259.9375,1350.375,271.9375,1338.375,283.9375,1185.375,283.9375,1173.375,271.9375,1185.375,259.9375" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="153" x="1185.375" y="275.7456">loop for all bss in this SSID</text><path d="M935.875,459.2305 L935.875,484.3633 A0,0 0 0 0 935.875,484.3633 L1083.875,484.3633 A0,0 0 0 0 1083.875,484.3633 L1083.875,477.2305 L1103.875,471.7969 L1083.875,469.2305 L1083.875,469.2305 L1073.875,459.2305 L935.875,459.2305 A0,0 0 0 0 935.875,459.2305 " fill="#FBFB77" filter="url(#f17pejpzmpq1g2)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1073.875,459.2305 L1073.875,469.2305 L1083.875,469.2305 L1073.875,459.2305 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="941.875" y="476.2974">no reassociate here</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="316" x="1103.875" y="454.8125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="296" x="1113.875" y="475.9512">wpa_supp_connect(wpa_s, new_bss, curr-&gt;ssid)</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="88" x="1638.875" y="259.9375"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="64" x="1652.875" y="281.0762">do nothing</text><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="1475.375,494.7813,1487.375,506.7813,1475.375,518.7813,1463.375,506.7813,1475.375,494.7813" style="stroke:#A80036;stroke-width:1.5;"/><path d="M1736.875,230.3555 L1736.875,255.4883 A0,0 0 0 0 1736.875,255.4883 L2249.875,255.4883 A0,0 0 0 0 2249.875,255.4883 L2249.875,248.3555 L2269.875,242.9219 L2249.875,240.3555 L2249.875,240.3555 L2239.875,230.3555 L1736.875,230.3555 A0,0 0 0 0 1736.875,230.3555 " fill="#FBFB77" filter="url(#f17pejpzmpq1g2)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M2239.875,230.3555 L2239.875,240.3555 L2249.875,240.3555 L2239.875,230.3555 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="492" x="1742.875" y="247.4224">Not connected to any network, last network also not found so keep scanning</text><rect fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" height="33.9688" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="236" x="2269.875" y="225.9375"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="216" x="2279.875" y="247.0762">wpa_supp_req_scan(wpa_s,2sec,0)</text><polygon fill="#FEFECE" filter="url(#f17pejpzmpq1g2)" points="1918.625,524.7813,1930.625,536.7813,1918.625,548.7813,1906.625,536.7813,1918.625,524.7813" style="stroke:#A80036;stroke-width:1.5;"/><ellipse cx="1918.625" cy="594.7813" fill="#FFFFFF" filter="url(#f17pejpzmpq1g2)" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="1918.625" cy="594.7813" fill="#000000" rx="6" ry="6" style="stroke:#7F7F7F;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1214.25" x2="1214.25" y1="30" y2="50"/><polygon fill="#A80036" points="1210.25,40,1214.25,50,1218.25,40,1214.25,44" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1214.25" x2="1214.25" y1="83.9688" y2="103.9688"/><polygon fill="#A80036" points="1210.25,93.9688,1214.25,103.9688,1218.25,93.9688,1214.25,97.9688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483.875" x2="483.875" y1="342.875" y2="377.875"/><polygon fill="#A80036" points="479.875,367.875,483.875,377.875,487.875,367.875,483.875,371.875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483.875" x2="483.875" y1="284.9063" y2="308.9063"/><polygon fill="#A80036" points="479.875,298.9063,483.875,308.9063,487.875,298.9063,483.875,302.9063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483.875" x2="483.875" y1="411.8438" y2="422.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483.875" x2="846.875" y1="422.8125" y2="422.8125"/><polygon fill="#A80036" points="842.875,358.375,846.875,348.375,850.875,358.375,846.875,354.375" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="846.875" x2="846.875" y1="272.9063" y2="422.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="846.875" x2="542.875" y1="272.9063" y2="272.9063"/><polygon fill="#A80036" points="552.875,268.9063,542.875,272.9063,552.875,276.9063,548.875,272.9063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="424.875" x2="120.875" y1="272.9063" y2="272.9063"/><polygon fill="#A80036" points="116.875,344.375,120.875,354.375,124.875,344.375,120.875,348.375" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="120.875" x2="120.875" y1="272.9063" y2="434.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="120.875" x2="483.875" y1="434.8125" y2="434.8125"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483.875" x2="483.875" y1="434.8125" y2="455.7813"/><polygon fill="#A80036" points="479.875,445.7813,483.875,455.7813,487.875,445.7813,483.875,449.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483.875" x2="483.875" y1="225.9063" y2="260.9063"/><polygon fill="#A80036" points="479.875,250.9063,483.875,260.9063,487.875,250.9063,483.875,254.9063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="301.75" x2="301.75" y1="641.1211" y2="676.1211"/><polygon fill="#A80036" points="297.75,666.1211,301.75,676.1211,305.75,666.1211,301.75,670.1211" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="301.75" x2="301.75" y1="582.75" y2="607.1523"/><polygon fill="#A80036" points="297.75,597.1523,301.75,607.1523,305.75,597.1523,301.75,601.1523" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="509.25" x2="521.25" y1="570.75" y2="570.75"/><polygon fill="#A80036" points="517.25,648.6211,521.25,658.6211,525.25,648.6211,521.25,652.6211" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="521.25" x2="521.25" y1="570.75" y2="742.0898"/><line style="stroke:#A80036;stroke-width:1.5;" x1="521.25" x2="313.75" y1="742.0898" y2="742.0898"/><polygon fill="#A80036" points="323.75,738.0898,313.75,742.0898,323.75,746.0898,319.75,742.0898" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="301.75" x2="301.75" y1="710.0898" y2="730.0898"/><polygon fill="#A80036" points="297.75,720.0898,301.75,730.0898,305.75,720.0898,301.75,724.0898" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="177.25" x2="151.5" y1="786.0898" y2="786.0898"/><line style="stroke:#A80036;stroke-width:1.5;" x1="151.5" x2="151.5" y1="786.0898" y2="808.0898"/><polygon fill="#A80036" points="147.5,798.0898,151.5,808.0898,155.5,798.0898,151.5,802.0898" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="426.25" x2="452" y1="786.0898" y2="786.0898"/><line style="stroke:#A80036;stroke-width:1.5;" x1="452" x2="452" y1="786.0898" y2="808.0898"/><polygon fill="#A80036" points="448,798.0898,452,808.0898,456,798.0898,452,802.0898" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="151.5" x2="151.5" y1="842.0586" y2="860.0586"/><line style="stroke:#A80036;stroke-width:1.5;" x1="151.5" x2="289.75" y1="860.0586" y2="860.0586"/><polygon fill="#A80036" points="279.75,856.0586,289.75,860.0586,279.75,864.0586,283.75,860.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="452" x2="452" y1="842.0586" y2="860.0586"/><line style="stroke:#A80036;stroke-width:1.5;" x1="452" x2="313.75" y1="860.0586" y2="860.0586"/><polygon fill="#A80036" points="323.75,856.0586,313.75,860.0586,323.75,864.0586,319.75,860.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="301.75" x2="301.75" y1="754.0898" y2="774.0898"/><polygon fill="#A80036" points="297.75,764.0898,301.75,774.0898,305.75,764.0898,301.75,768.0898" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="459.875" x2="301.75" y1="536.75" y2="536.75"/><line style="stroke:#A80036;stroke-width:1.5;" x1="301.75" x2="301.75" y1="536.75" y2="558.75"/><polygon fill="#A80036" points="297.75,548.75,301.75,558.75,305.75,548.75,301.75,552.75" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="507.875" x2="666" y1="536.75" y2="536.75"/><line style="stroke:#A80036;stroke-width:1.5;" x1="666" x2="666" y1="536.75" y2="558.75"/><polygon fill="#A80036" points="662,548.75,666,558.75,670,548.75,666,552.75" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="301.75" x2="301.75" y1="872.0586" y2="890.0586"/><line style="stroke:#A80036;stroke-width:1.5;" x1="301.75" x2="471.875" y1="890.0586" y2="890.0586"/><polygon fill="#A80036" points="461.875,886.0586,471.875,890.0586,461.875,894.0586,465.875,890.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="666" x2="666" y1="592.7188" y2="890.0586"/><line style="stroke:#A80036;stroke-width:1.5;" x1="666" x2="495.875" y1="890.0586" y2="890.0586"/><polygon fill="#A80036" points="505.875,886.0586,495.875,890.0586,505.875,894.0586,501.875,890.0586" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483.875" x2="483.875" y1="489.75" y2="524.75"/><polygon fill="#A80036" points="479.875,514.75,483.875,524.75,487.875,514.75,483.875,518.75" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1261.875" x2="1261.875" y1="341.9063" y2="376.9063"/><polygon fill="#A80036" points="1257.875,366.9063,1261.875,376.9063,1265.875,366.9063,1261.875,370.9063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1261.875" x2="1261.875" y1="283.9375" y2="307.9375"/><polygon fill="#A80036" points="1257.875,297.9375,1261.875,307.9375,1265.875,297.9375,1261.875,301.9375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1261.875" x2="1261.875" y1="410.875" y2="421.8438"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1261.875" x2="1624.875" y1="421.8438" y2="421.8438"/><polygon fill="#A80036" points="1620.875,357.4063,1624.875,347.4063,1628.875,357.4063,1624.875,353.4063" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1624.875" x2="1624.875" y1="271.9375" y2="421.8438"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1624.875" x2="1350.375" y1="271.9375" y2="271.9375"/><polygon fill="#A80036" points="1360.375,267.9375,1350.375,271.9375,1360.375,275.9375,1356.375,271.9375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1173.375" x2="898.875" y1="271.9375" y2="271.9375"/><polygon fill="#A80036" points="894.875,343.4063,898.875,353.4063,902.875,343.4063,898.875,347.4063" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="898.875" x2="898.875" y1="271.9375" y2="433.8438"/><line style="stroke:#A80036;stroke-width:1.5;" x1="898.875" x2="1261.875" y1="433.8438" y2="433.8438"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1261.875" x2="1261.875" y1="433.8438" y2="454.8125"/><polygon fill="#A80036" points="1257.875,444.8125,1261.875,454.8125,1265.875,444.8125,1261.875,448.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1451.375" x2="1261.875" y1="237.9375" y2="237.9375"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1261.875" x2="1261.875" y1="237.9375" y2="259.9375"/><polygon fill="#A80036" points="1257.875,249.9375,1261.875,259.9375,1265.875,249.9375,1261.875,253.9375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1499.375" x2="1682.875" y1="237.9375" y2="237.9375"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1682.875" x2="1682.875" y1="237.9375" y2="259.9375"/><polygon fill="#A80036" points="1678.875,249.9375,1682.875,259.9375,1686.875,249.9375,1682.875,253.9375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1261.875" x2="1261.875" y1="488.7813" y2="506.7813"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1261.875" x2="1463.375" y1="506.7813" y2="506.7813"/><polygon fill="#A80036" points="1453.375,502.7813,1463.375,506.7813,1453.375,510.7813,1457.375,506.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1682.875" x2="1682.875" y1="293.9063" y2="506.7813"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1682.875" x2="1487.375" y1="506.7813" y2="506.7813"/><polygon fill="#A80036" points="1497.375,502.7813,1487.375,506.7813,1497.375,510.7813,1493.375,506.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1865.125" x2="1475.375" y1="203.9375" y2="203.9375"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1475.375" x2="1475.375" y1="203.9375" y2="225.9375"/><polygon fill="#A80036" points="1471.375,215.9375,1475.375,225.9375,1479.375,215.9375,1475.375,219.9375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1972.125" x2="2387.875" y1="203.9375" y2="203.9375"/><line style="stroke:#A80036;stroke-width:1.5;" x1="2387.875" x2="2387.875" y1="203.9375" y2="225.9375"/><polygon fill="#A80036" points="2383.875,215.9375,2387.875,225.9375,2391.875,215.9375,2387.875,219.9375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1475.375" x2="1475.375" y1="518.7813" y2="536.7813"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1475.375" x2="1906.625" y1="536.7813" y2="536.7813"/><polygon fill="#A80036" points="1896.625,532.7813,1906.625,536.7813,1896.625,540.7813,1900.625,536.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="2387.875" x2="2387.875" y1="259.9063" y2="536.7813"/><line style="stroke:#A80036;stroke-width:1.5;" x1="2387.875" x2="1930.625" y1="536.7813" y2="536.7813"/><polygon fill="#A80036" points="1940.625,532.7813,1930.625,536.7813,1940.625,540.7813,1936.625,536.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1918.625" x2="1918.625" y1="548.7813" y2="583.7813"/><polygon fill="#A80036" points="1914.625,573.7813,1918.625,583.7813,1922.625,573.7813,1918.625,577.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1049.75" x2="483.875" y1="169.9375" y2="169.9375"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483.875" x2="483.875" y1="169.9375" y2="191.9375"/><polygon fill="#A80036" points="479.875,181.9375,483.875,191.9375,487.875,181.9375,483.875,185.9375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1378.75" x2="1918.625" y1="169.9375" y2="169.9375"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1918.625" x2="1918.625" y1="169.9375" y2="191.9375"/><polygon fill="#A80036" points="1914.625,181.9375,1918.625,191.9375,1922.625,181.9375,1918.625,185.9375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483.875" x2="483.875" y1="902.0586" y2="908.0586"/><line style="stroke:#A80036;stroke-width:1.5;" x1="483.875" x2="1214.25" y1="908.0586" y2="908.0586"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1214.25" x2="1214.25" y1="137.9375" y2="157.9375"/><polygon fill="#A80036" points="1210.25,147.9375,1214.25,157.9375,1218.25,147.9375,1214.25,151.9375" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[97f88a746203cc6e37f628ca5be54ee6]
@startuml
start
  : For every scan Result 3 functions -> wpa_bss_update_start,wpa_bss_update_scan_res,wpa_bss_update_end;
  :wpa_bss_update_end(struct wpa_supplicant *wpa_s, struct scan_info *info, int new_scan);
note left: End BSS table update from scan result, wpa_supplicant/bss.c
if (wpa_s->current_bss? connected to any network now?) then (yes)
  :add_to_advantech_whitelist(current_bss- ->bssid);
   while (loop in bss table)
   : for every BSSID, initialize new_bss and reassign new_bss=current_bss, if current_bss->level > new_bss->level;
   : after loop, we have best BSSID, new_bss;
   endwhile
  :wpa_get_network();
  if (n/w) then (yes)
    if (new BSSID roaming levels are better than current roaming levels ? ) then (yes)
       :wpa_s_reassociate=1;
       :wpa_supp_connect(wpa_s, new_bss, curr->ssid);
    endif
    if (n/w autoRoaming && roam scan is >=0) then (yes)
        :wpa_supp_request_scan(dlog scan period);
    else
        :wpa_supp_request_scan(default 2 second);
    endif
  else
   : do nothing;
  endif
else
   if (any last SSID?) then (yes)
     if (n/w) then (yes)
     while (loop for all bss in this SSID)
      : for every BSSID, initialize new_bss and reassign new_bss=current_bss, if current_bss->level > new_bss->level;
      : after loop, we have best BSSID, new_bss;
     endwhile
     :wpa_supp_connect(wpa_s, new_bss, curr->ssid);
note left: no reassociate here
     else
      : do nothing;
     endif 
   else
:wpa_supp_req_scan(wpa_s,2sec,0);
note left:  Not connected to any network, last network also not found so keep scanning
endif
stop
@enduml

PlantUML version 1.2021.2beta5(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>